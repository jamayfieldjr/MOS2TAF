#===========================================================================================
#===========================================================================================
#===========================================================================================

#KMEM   NAM MOS GUIDANCE   11/09/2018  0000 UTC                        1
#DT /NOV   9            /NOV  10                /NOV  11          /    2
#HR   06 09 12 15 18 21 00 03 06 09 12 15 18 21 00 03 06 09 12 18 00   3
#X/N                    52          29          41          29    49   4
#TMP  50 47 44 46 49 50 45 42 38 34 30 29 37 41 35 32 31 31 31 46 45   5
#DPT  38 37 36 37 35 32 31 32 28 25 21 17 15 15 17 19 20 21 23 25 31   6
#CLD  OV OV OV OV BK CL CL CL CL CL FW FW CL CL SC SC SC BK OV BK OV   7
#WDR  36 36 35 35 35 35 34 35 34 36 01 03 03 04 04 09 08 12 12 21 29   8
#WSP  08 09 08 12 10 10 07 09 08 08 10 10 07 05 05 03 03 03 02 05 03   9
#P06        80    25     5     3     2     3     4     5     7  7  7  10 
#P12                    29           4           4           7    11  11
#Q06         2     0     0     0     0     0     0     0     0  0  0  12
#Q12                     0           0           0           0     0  13
#T06      3/ 5  0/ 7  0/ 9  0/ 4  0/ 8  0/ 3  0/ 3  0/ 8  1/ 2  1/ 6  14
#T12            3/ 7        0/12        0/ 8        0/ 8     4/ 4     15
#POZ   0  1  1  0  0  0  0  0  0  0  9  7  6  3  7  9  5  4  4  0  0  16 
#POS   0  0  0  5  0  2 11 31 76 85 77 87 75 88 61 41 15  0  0  3  3  17
#TYP   R  R  R  R  R  R  R  R  S  S  S  S  S  S  S  S  R  R  R  R  R  18
#SNW                                 0                       0        19
#CIG   6  4  4  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  7  20
#VIS   7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  21
#OBV   N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  22

#===========================================================================================
#===========================================================================================
#====================================================================================
#KSEA   SEATTLE-TACOMA        GFS LAMP GUIDANCE  11/02/2018  0500 UTC               0
#UTC  06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 00 01 02 03 04 05 06    1
#TMP  58 58 58 58 58 58 58 57 57 57 57 57 58 58 58 59 59 58 57 56 55 54 54 54 54    2
#DPT  53 53 53 52 52 52 52 51 51 50 50 50 50 49 49 48 48 47 47 47 47 47 47 47 48    3 
#WDR  18 19 19 20 20 20 21 21 22 23 23 24 23 23 23 22 22 22 21 22 23 23 21 19 17    4 
#WSP  18 18 18 19 18 18 18 19 22 23 23 21 21 21 19 18 19 18 16 14 13 11 09 08 07    5
#WGS  27 27 27 28 27 26 26 27 30 30 31 28 29 29 26 25 26 25 24 21 20 18 NG NG NG    6
#PPO  35 41 49 56 52 50 52 46 42 35 30 25 18 19 19 19 18 18 16 12 11  9  7  6  5    7
#PCO   N  Y  Y  Y  Y  Y  Y  Y  Y  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N    8
#P06                    88                66                52                22    9
#LP1   0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   10
#LC1   N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N   11
#CP1   1  4  9 14 20 14 18 19 21 19 16 12  8  8  9 11 12 10  8  7  6  6  5  4  2   12
#CC1   N  N  N  L  M  L  L  M  M  M  L  L  N  N  N  N  L  N  N  N  N  N  N  N  N   13
#POZ   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   14
#POS   0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   15
#TYP   R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R  R   16
#CLD  OV OV OV OV OV OV OV OV BK BK BK BK BK BK BK BK BK BK BK OV OV OV OV OV OV   17
#CIG   5  5  5  5  4  4  4  4  5  5  5  5  6  6  6  6  6  6  6  6  6  6  6  6  6   18
#CCG   5  5  5  5  5  4  4  4  5  5  5  5  5  5  5  5  6  6  6  6  6  6  6  6  5   19
#VIS   6  7  7  5  5  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7   20
#CVS   5  5  5  5  5  5  5  5  6  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7   21
#OBV   N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N   22
#====================================================================================
 #PANC   ANCHORAGE             GFS LAMP GUIDANCE  11/03/2018  0200 UTC              0 
 #UTC  03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 00 01 02 03   1
 #TMP  29 28 27 27 26 26 26 26 26 26 25 25 25 25 25 26 28 30 31 32 33 34 34 33 31   2 
 #DPT  15 16 16 15 15 15 16 15 15 15 14 14 15 15 16 17 18 19 19 20 20 20 20 19 19   3
 #WDR  36 36 36 36 36 36 36 36 36 36 36 01 01 01 01 01 01 01 01 02 02 02 03 03 04   4
 #WSP  05 05 05 05 05 05 05 06 06 06 07 07 06 06 06 05 05 06 06 06 05 05 05 04 04   5
 #WGS  NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG NG   6
 #PPO   0  0  0  0  0  0  0  0  0  1  2  3  3  4  4  5  5  5  5  4  3  3  2  1  1   7
 #PCO   N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N   8
 #P06                              0                 4                 2            9
 #POZ   2  3  5  5  4  2  4  1  3  2  1  1  2  5  5  4  6  6  6  4  4  2  4  4  5  10
 #POS  98 97 93 92 90 90 83 87 85 85 87 90 89 83 86 86 85 85 79 72 67 65 64 66 68  11
 #TYP   S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  S  12
 #CLD  BK BK BK BK BK BK BK BK BK OV OV OV OV OV OV BK BK BK BK BK BK BK BK BK BK  13
 #CIG   8  8  8  8  8  8  7  7  7  7  7  7  6  6  6  7  7  7  7  7  7  7  7  7  7  14
 #CCG   7  6  6  6  6  6  6  6  6  6  6  6  5  6  6  6  6  5  6  5  5  6  6  6  6  15
 #VIS   7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  16
 #CVS   7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  6  17
 #OBV   N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  N  18
#====================================================================================

#UTC Hour of the day in UTC time. This is the hour at which the forecast is valid, or if the forecast is valid for a period, the end of the forecast period.
#TMP surface temperature valid at that hour.
#DPT surface dewpoint valid at that hour.
#WDR forecasts of the 10-meter wind direction at the hour, given in tens of degrees.
#WSP forecasts of the 10-meter wind speed at the hour, given in knots.
#WGS forecasts of the 10-meter wind gust at the hour, given in knots.  "NG" means that no gust is forecast.
#PPO probability of precipitation occurring on the hour.  The precipitation need not be measurable.
#P06 probability of measurable precipitation (PoP) during a 6-h period ending at that time.
#PCO categorical forecast of yes (Y) or no (N) indicating if precipitation, not necessarily measurable, will occur on the hour.
#LP1 probability of lightning (at least one total lightning flash) occurring during the 1-hr period ending at the indicated time.
#LC1 categorical forecast of no (N), low (L), medium (M), or high (H) potential for lightning (at least one total lightning flash) occurring during the 1-hr period ending at the indicated time.
#CP1 probability of convection (at least one total lightning flash and/or radar reflectivity of 40dBZ or higher) occurring during the 1-hr period ending at the indicated time.
#CC1 categorical forecast of no (N), low (L), medium (M), or high (H) potential for convection (at least one total lightning flash and/or radar reflectivity of 40dBZ or higher) occurring during the 1-hr period ending at the indicated time.
#POZ* conditional probability of freezing pcp occurring at the hour.  This probability is conditional on precipitation occurring.
#POS* conditional probability of snow occurring at the hour.  This probability is conditional on precipitation occurring.
#TYP* conditional precipitation type at the hour.  This category forecast is conditional on precipitation occurring.
#CLD forecast categories of total sky cover valid at that hour.
#CIG ceiling height categorical forecasts at the hour.
#CCG conditional ceiling height categorical forecasts at the hour.   This category forecast is conditional on precipitation occurring.
#VIS visibility categorical forecasts at the hour.
#CVS conditional visibility categorical forecasts at the hour.   This category forecast is conditional on precipitation occurring.
#OBV obstruction to vision categorical forecasts at the hour.
#====================================================================================

#import libraries
from urllib.request import urlopen
from bs4 import BeautifulSoup
import datetime

station_id = "KIND" 
short_station_id = station_id[1:4]

quote_page = "http://www.nws.noaa.gov/cgi-bin/lamp/getlav.pl?sta="+station_id
quote_page1 = "http://www.nws.noaa.gov/cgi-bin/mos/getmet.pl?sta="+station_id
quote_page2 = "http://www.nws.noaa.gov/cgi-bin/mos/getmav.pl?sta="+station_id
quote_page3 = "https://www.aviationweather.gov/metar/data?ids="+station_id+"&format=raw&date=&hours=3"
quote_page4 = "https://forecast.weather.gov/product.php?site=meg&product=TAF&issuedby="+short_station_id
quote_page5 = "https://www.wrh.noaa.gov/mesowest/timeseries.php?wfo=wrh&num=24&banner=NONE&hfmetars=1&sid=KMEM"

html = urlopen(quote_page3)
soup = BeautifulSoup(html,"html.parser")
#features = "html.parser"
text = str(soup.find_all('code'))

def remove_html_tags(text):
    """Remove html tags from a string"""
    import re
    clean = re.compile('<.*?>')
    return re.sub(clean, '', text)

#print(remove_html_tags(text))
cleantext=remove_html_tags(text) 
cleantext=re.split(",",cleantext)

for values in cleantext:
  print(values);

print(' ')
#====================================================================================
#====================================================================================

html = urlopen(quote_page)
#print(html.read())

soup = BeautifulSoup(html,"html.parser")
text = str(soup.find_all('pre'))
lines=text.splitlines()
#print(lines)

#===================================================================================
#STATION INFO
station_info = lines[1].split()
#print(str(station_info))
station_name = 'STATION NAME: '+station_info[0]
#print(str(station_name))
initalized_time = 'INITIALIZED TIME: ' + station_info[6] +'Z'
#print(str(initalized_time))
#===================================================================================
#===================================================================================
#TIME_VECTOR
time_vector = lines[2].split()
#print(time_vector)
time_vector = (time_vector[1:len(time_vector)])
#print(time_vector)
#time = ['']*len(time_vector)
#print(time)
#print(time_vector)
time = [ s + '00' for s in time_vector]
#print(time)
fm_times=["FM" + s for s in time]
#print(fm_times)
#===================================================================================
#===================================================================================
#TEMP_VECTOR
temp = lines[3].split()
#print(temp)
temp = temp[1:len(temp)]
temp_new = [int(x) for x in temp]
#print(type(temp))
temp_c = [(round(((y - 32) * 5.0 / 9.0))) for y in temp_new]
#print(type(temp_c))
temp_c=map(str,temp_c)
final_temp_c=[x.replace('-', 'M') for x in temp_c]
#print(final_temp_c)
#===================================================================================
#===================================================================================
#DEW_POINT_TEMP_VECTOR
dew_point = lines[4].split()
#print(temp)
dew_point = dew_point[1:len(dew_point)]
dew_point_new = [int(x) for x in dew_point]
#print(type(temp))
dew_point_c = [(round(((y - 32) * 5.0 / 9.0))) for y in dew_point_new]
#print(type(dew_point_c))
dew_point_c=map(str,dew_point_c)
final_dew_point_c=[x.replace('-', 'M') for x in dew_point_c]
#print(final_dew_point_c)

[final_temp_c,'/',final_dew_point_c]
full_temp=['/'.join(map(str, i)) for i in zip(final_temp_c, final_dew_point_c)]
#===================================================================================
#===================================================================================
#WIND DIRECTION 
wind_dir = lines[5].split()
wind_dir = wind_dir[1:len(wind_dir)]
wind_dir=list(map(lambda k: k+'0', wind_dir))
#print(wind_dir)
#===================================================================================
#===================================================================================
#WIND SPEED
wind_spd = lines[6].split()
wind_spd = wind_spd[1:len(wind_spd)]
wind_spd=list(map(lambda k: k+'KT', wind_spd))
#print(wind_spd)
#===================================================================================
#===================================================================================
#COMBINING WIND DIRECTION AND WIND SPEED
wind=[''.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(wind)
full_wind=['/'.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(full_wind)
#===================================================================================
#===================================================================================
#CLOUD TYPE  
cloud_type = lines[18].split()
#print(cloud_type)
cloud_type = cloud_type[1:len(cloud_type)]
#print(cloud_type)
#===================================================================================
#===================================================================================
#CLOUD HEIGHT
cloud_height = lines[19].split()
#print(cloud_height)
cloud_height = cloud_height[1:len(cloud_height)]
#print(cloud_height)

#===================================================================================
#===================================================================================
#probability of precipitation
precip_prob=lines[8]
precip_prob = precip_prob [5:len(precip_prob )]

def split(s, n):
    if len(s) < n:
        return []
    else:
        return [s[:n]] + split(s[n:], n) 

precip_prob  =  split(precip_prob ,3)
pcp = ['PRECIP:']*len(precip_prob)
precentage = ['% ']*len(precip_prob)
zipped_precip_prob =[''.join(map(str, i)) for i in zip(pcp, precip_prob, precentage)]
#===================================================================================
#===================================================================================
#Conditional Probability of snow occurring at the hour.
lol = lines[16]
lol = lol[5:len(lol)]
snow_prob  =  split(lol, 3)
pcp = ['SN: ']*len(snow_prob)
precentage = ['% ']*len(snow_prob)
zipped_snow_prob =[''.join(map(str, i)) for i in zip(pcp, snow_prob, precentage)]
#===================================================================================
#===================================================================================
#Conditional Probability of ice occurring at the hour.
lol= lines[15]
lol = lol[5:len(lol)]
ice_prob  =  split(lol, 3)
pcp = ['IC: ']*len(ice_prob)
precentage = ['% ']*len(ice_prob)
zipped_ice_prob =[''.join(map(str, i)) for i in zip(pcp, ice_prob, precentage)]
#===================================================================================
#===================================================================================

#probability of lightning 
lgt_prob = lines[11]
lol = lol[4:len(lol)]
lgt_prob  =  split(lol, 3)
pcp = ['LGT: ']*len(lgt_prob)
precentage = ['% ']*len(lgt_prob)
zipped_lgt_prob =[''.join(map(str, i)) for i in zip(pcp, lgt_prob, precentage)]
#===================================================================================
#===================================================================================
#COMBINING CLOUD TYPE AND CLOUD HEIGHT
zipped_height_types=[''.join(map(str, i)) for i in zip(cloud_type, cloud_height)]
#print(zipped_height_types)

cloud_type_hash={ 'CL':'SKC', 'FW':'FEW', 'SC':'SCT', 'BK':'BKN', 'OV':'OVC' }

cloud_height_hash={ '1': ' 200', '2' : ' 200-400', '3' : ' 500-900', '4' : ' 1000-1900', '5' : ' 2000-3000','6' : ' 3100-6500', '7' : ' 6600-12000', '8' : ' 12000' }
results = []
for ht in zipped_height_types:
 htype = ht[:2]
 val = ht[2:]
 res = cloud_type_hash[htype] + cloud_height_hash[val]
 results.append(res)
 #print(zipped_full_clouds)
 #print(type(zipped_full_clouds))
#print(results) 

#===================================================================================
#===================================================================================

#very low instrument flight rules	VLIFR	< 200 feet	< 0.5 mile
#low instrument flight rules	LIFR	> 200 feet and < 500 feet	> 0.5 mile and < 1 mile
#instrument flight rules	IFR	> 500 and < 1000 feet	> 1 and < 3 miles
#marginal visual flight rules	MVFR	> 1000 and < 3000 feet	> 3 and <5 miles
#visual flight rules	VFR	> 3000 feet	> 5 miles

#'BK':'BKN', 'OV':'OVC' 


#===================================================================================
#===================================================================================
#VISIBILITY
vis = lines[21].split()
vis = vis[1:len(vis)]

visibility_hash={ '1':'M1/2SM FG', '2':'1/2SM-1SM FG/BR', '3':'1SM-2SM BR', '4':'2SM-3SM BR', '5':'3SM-5SM BR', '6':'6SM BR', '7':'P6SM'}
visresults = []
for v in vis:
 val = v[:2]
 res = visibility_hash[val] 
 visresults.append(res)

#===================================================================================
#===================================================================================

#print(vis)
#print(fm_times)
x = zip(fm_times, full_wind, results, visresults, full_temp, zipped_precip_prob, zipped_snow_prob, zipped_ice_prob, zipped_lgt_prob)
#for values in x:
#  print(values);

new_data = list(' '.join(w) for w in x)
#print(new_data)

#https://stackoverflow.com/questions/1815316/why-cant-i-join-this-tuple-in-python

onepiece = station_info[0]
twopiece = ' FT GFS LAMP '

elevenpiece =  datetime.datetime.today().strftime('%H%M')
elevenpiece = [elevenpiece,'Z']
elevenpiece = ''.join(elevenpiece)
#print(elevenpiece)

threepiece =  datetime.datetime.today().strftime('%d')
fourpiece = time[0][:2]
fivepiece = [threepiece,fourpiece]
fivepiece=''.join(fivepiece)

sixpiece = str(datetime.date.today() + datetime.timedelta(days=1))
sevenpiece = sixpiece[-2:] 
eightpiece = int(time[len(time)-1][:2])+1
eightpiece = ''.join(['0',str(eightpiece)])
ninepiece = [sevenpiece,eightpiece]
ninepiece =''.join(ninepiece)

tenpiece = [fivepiece,ninepiece]
tenpiece ='/'.join(tenpiece)

tenpiece = [onepiece,twopiece,tenpiece,' ',elevenpiece,new_data[0][6:]]
tenpiece =''.join(tenpiece)
print(tenpiece)
new_data = new_data[1:len(new_data)] 

for values in new_data:
  print(values);

print(' ')

html = urlopen(quote_page1)
#print(html.read())

soup = BeautifulSoup(html,"html.parser")
text = str(soup.find_all('pre'))
lines=text.splitlines()
#print(lines)

#===================================================================================
#STATION INFO
station_info = lines[1].split()
#print(str(station_info))
station_name = 'STATION NAME: '+station_info[0]
#print(str(station_name))
initalized_time = 'INITIALIZED TIME: ' + station_info[6] +'Z'
#print(str(initalized_time))
#===================================================================================
#===================================================================================
#TIME_VECTOR
time_vector = lines[3].split()
#print(time_vector)
time_vector = (time_vector[1:9])
#print(time_vector)
#time = ['']*len(time_vector)
#print(time)
#print(time_vector)
time = [ s + '00' for s in time_vector]
#print(time)
fm_times=["FM" + s for s in time]
#print(fm_times)
#===================================================================================
#===================================================================================
#TEMP_VECTOR
temp = lines[5].split()
#print(temp)
temp = temp[1:9]
temp_new = [int(x) for x in temp]
#print(type(temp))
temp_c = [(round(((y - 32) * 5.0 / 9.0))) for y in temp_new]
#print(type(temp_c))
temp_c=map(str,temp_c)
final_temp_c=[x.replace('-', 'M') for x in temp_c]
#print(final_temp_c)
#===================================================================================
#===================================================================================
#DEW_POINT_TEMP_VECTOR
dew_point = lines[6].split()
#print(temp)
dew_point = dew_point[1:9]
dew_point_new = [int(x) for x in dew_point]
#print(type(temp))
dew_point_c = [(round(((y - 32) * 5.0 / 9.0))) for y in dew_point_new]
#print(type(dew_point_c))
dew_point_c=map(str,dew_point_c)
final_dew_point_c=[x.replace('-', 'M') for x in dew_point_c]
#print(final_dew_point_c)

[final_temp_c,'/',final_dew_point_c]
full_temp=['/'.join(map(str, i)) for i in zip(final_temp_c, final_dew_point_c)]
#===================================================================================
#===================================================================================
#WIND DIRECTION 
wind_dir = lines[8].split()
wind_dir = wind_dir[1:9]
wind_dir=list(map(lambda k: k+'0', wind_dir))
#print(wind_dir)
#===================================================================================
#===================================================================================
#WIND SPEED
wind_spd = lines[9].split()
wind_spd = wind_spd[1:9]
wind_spd=list(map(lambda k: k+'KT', wind_spd))
#print(wind_spd)
#===================================================================================
#===================================================================================
#COMBINING WIND DIRECTION AND WIND SPEED
wind=[''.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(wind)
full_wind=['/'.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(full_wind)
#===================================================================================
#===================================================================================
#CLOUD TYPE  
cloud_type = lines[7].split()
#print(cloud_type)
cloud_type = cloud_type[1:9]
#print(cloud_type)
#===================================================================================
#===================================================================================
#CLOUD HEIGHT
cloud_height = lines[20].split()
#print(cloud_height)
cloud_height = cloud_height[1:9]
#print(cloud_height)
#===================================================================================
#===================================================================================
#COMBINING CLOUD TYPE AND CLOUD HEIGHT
zipped_height_types=[''.join(map(str, i)) for i in zip(cloud_type, cloud_height)]
#print(zipped_height_types)

cloud_type_hash={ 'CL':'SKC', 'FW':'FEW', 'SC':'SCT', 'BK':'BKN', 'OV':'OVC' }

cloud_height_hash={ '1': ' 200', '2' : ' 200-400', '3' : ' 500-900', '4' : ' 1000-1900', '5' : ' 2000-3000','6' : ' 3100-6500', '7' : ' 6600-12000', '8' : ' 12000' }
results = []
for ht in zipped_height_types:
 htype = ht[:2]
 val = ht[2:]
 res = cloud_type_hash[htype] + cloud_height_hash[val]
 results.append(res)
 #print(zipped_full_clouds)
 #print(type(zipped_full_clouds))
#print(results) 
#===================================================================================
#===================================================================================
#VISIBILITY
vis = lines[21].split()
vis = vis[1:len(vis)]

visibility_hash={ '1':'M1/2SM FG', '2':'1/2SM-1SM FG/BR', '3':'1SM-2SM BR', '4':'2SM-3SM BR', '5':'3SM-5SM BR', '6':'6SM BR', '7':'P6SM'}
visresults = []
for v in vis:
 val = v[:2]
 res = visibility_hash[val] 
 visresults.append(res)

#print(vis)

x = zip(fm_times, full_wind, results, visresults, full_temp)
#for values in x:
#  print(values);

new_data = list(' '.join(w) for w in x)
#print(new_data)

#https://stackoverflow.com/questions/1815316/why-cant-i-join-this-tuple-in-python

onepiece = station_info[0]
twopiece = ' FT NAM MOS '

elevenpiece =  datetime.datetime.today().strftime('%H%M')
elevenpiece = [elevenpiece,'Z']
elevenpiece = ''.join(elevenpiece)
#print(elevenpiece)

threepiece =  datetime.datetime.today().strftime('%d')
fourpiece = time[0][:2]
fivepiece = [threepiece,fourpiece]
fivepiece=''.join(fivepiece)

sixpiece = str(datetime.date.today() + datetime.timedelta(days=3))
sevenpiece = sixpiece[-2:] 
eightpiece = int(time[len(time)-1][:2])+3
eightpiece = ''.join(['0',str(eightpiece)])
ninepiece = [sevenpiece,eightpiece]
ninepiece =''.join(ninepiece)

tenpiece = [fivepiece,ninepiece]
tenpiece ='/'.join(tenpiece)

tenpiece = [onepiece,twopiece,tenpiece,' ',elevenpiece,new_data[0][6:]]
tenpiece =''.join(tenpiece)
print(tenpiece)
new_data = new_data[1:len(new_data)] 

for values in new_data:
  print(values);

print(' ')
#===================================================================================
#===================================================================================
#===================================================================================

html = urlopen(quote_page2)
#print(html.read())

soup = BeautifulSoup(html,"html.parser")
text = str(soup.find_all('pre'))
lines=text.splitlines()
#print(lines)

#===================================================================================
#STATION INFO
station_info = lines[1].split()
#print(str(station_info))
station_name = 'STATION NAME: '+station_info[0]
#print(str(station_name))
initalized_time = 'INITIALIZED TIME: ' + station_info[6] +'Z'
#print(str(initalized_time))
#===================================================================================
#===================================================================================
#TIME_VECTOR
time_vector = lines[3].split()
#print(time_vector)
time_vector = (time_vector[1:9])
#print(time_vector)
#time = ['']*len(time_vector)
#print(time)
#print(time_vector)
time = [ s + '00' for s in time_vector]
#print(time)
fm_times=["FM" + s for s in time]
#print(fm_times)
#===================================================================================
#===================================================================================
#TEMP_VECTOR
temp = lines[5].split()
#print(temp)
temp = temp[1:9]
temp_new = [int(x) for x in temp]
#print(type(temp))
temp_c = [(round(((y - 32) * 5.0 / 9.0))) for y in temp_new]
#print(type(temp_c))
temp_c=map(str,temp_c)
final_temp_c=[x.replace('-', 'M') for x in temp_c]
#print(final_temp_c)
#===================================================================================
#===================================================================================
#DEW_POINT_TEMP_VECTOR
dew_point = lines[6].split()
#print(temp)
dew_point = dew_point[1:9]
dew_point_new = [int(x) for x in dew_point]
#print(type(temp))
dew_point_c = [(round(((y - 32) * 5.0 / 9.0))) for y in dew_point_new]
#print(type(dew_point_c))
dew_point_c=map(str,dew_point_c)
final_dew_point_c=[x.replace('-', 'M') for x in dew_point_c]
#print(final_dew_point_c)

[final_temp_c,'/',final_dew_point_c]
full_temp=['/'.join(map(str, i)) for i in zip(final_temp_c, final_dew_point_c)]
#===================================================================================
#===================================================================================
#WIND DIRECTION 
wind_dir = lines[8].split()
wind_dir = wind_dir[1:9]
wind_dir=list(map(lambda k: k+'0', wind_dir))
#print(wind_dir)
#===================================================================================
#===================================================================================
#WIND SPEED
wind_spd = lines[9].split()
wind_spd = wind_spd[1:9]
wind_spd=list(map(lambda k: k+'KT', wind_spd))
#print(wind_spd)
#===================================================================================
#===================================================================================
#COMBINING WIND DIRECTION AND WIND SPEED
wind=[''.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(wind)
full_wind=['/'.join(map(str, i)) for i in zip(wind_dir, wind_spd)]
#print(full_wind)
#===================================================================================
#===================================================================================
#CLOUD TYPE  
cloud_type = lines[7].split()
#print(cloud_type)
cloud_type = cloud_type[1:9]
#print(cloud_type)
#===================================================================================
#===================================================================================
#CLOUD HEIGHT
cloud_height = lines[20].split()
#print(cloud_height)
cloud_height = cloud_height[1:9]
#print(cloud_height)
#===================================================================================
#===================================================================================
#COMBINING CLOUD TYPE AND CLOUD HEIGHT
zipped_height_types=[''.join(map(str, i)) for i in zip(cloud_type, cloud_height)]
#print(zipped_height_types)

cloud_type_hash={ 'CL':'SKC', 'FW':'FEW', 'SC':'SCT', 'BK':'BKN', 'OV':'OVC' }

cloud_height_hash={ '1': ' 200', '2' : ' 200-400', '3' : ' 500-900', '4' : ' 1000-1900', '5' : ' 2000-3000','6' : ' 3100-6500', '7' : ' 6600-12000', '8' : ' 12000' }
results = []
for ht in zipped_height_types:
 htype = ht[:2]
 val = ht[2:]
 res = cloud_type_hash[htype] + cloud_height_hash[val]
 results.append(res)
 #print(zipped_full_clouds)
 #print(type(zipped_full_clouds))
#print(results) 
#===================================================================================
#===================================================================================
#VISIBILITY
vis = lines[21].split()
vis = vis[1:len(vis)]

visibility_hash={ '1':'M1/2SM FG', '2':'1/2SM-1SM FG/BR', '3':'1SM-2SM BR', '4':'2SM-3SM BR', '5':'3SM-5SM BR', '6':'6SM BR', '7':'P6SM'}
visresults = []
for v in vis:
 val = v[:2]
 res = visibility_hash[val] 
 visresults.append(res)


#print(vis)

x = zip(fm_times, full_wind, results, visresults, full_temp)
#for values in x:
#  print(values);

new_data = list(' '.join(w) for w in x)
#print(new_data)

#https://stackoverflow.com/questions/1815316/why-cant-i-join-this-tuple-in-python

onepiece = station_info[0]
twopiece = ' FT GFS MOS '

elevenpiece =  datetime.datetime.today().strftime('%H%M')
elevenpiece = [elevenpiece,'Z']
elevenpiece = ''.join(elevenpiece)
#print(elevenpiece)

threepiece =  datetime.datetime.today().strftime('%d')
fourpiece = time[0][:2]
fivepiece = [threepiece,fourpiece]
fivepiece=''.join(fivepiece)

sixpiece = str(datetime.date.today() + datetime.timedelta(days=3))
sevenpiece = sixpiece[-2:] 
eightpiece = int(time[len(time)-1][:2])+3
eightpiece = ''.join(['0',str(eightpiece)])
ninepiece = [sevenpiece,eightpiece]
ninepiece =''.join(ninepiece)

tenpiece = [fivepiece,ninepiece]
tenpiece ='/'.join(tenpiece)

tenpiece = [onepiece,twopiece,tenpiece,' ',elevenpiece,new_data[0][6:]]
tenpiece =''.join(tenpiece)
print(tenpiece)
new_data = new_data[1:len(new_data)] 

for values in new_data:
  print(values);

print(' ')
#===================================================================================
#===================================================================================
#===================================================================================
